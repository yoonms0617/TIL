## 사용자 관리

### 사용자 목록

```sql
$ SELECT * FROM mysql.user;
```

### 사용자 생성

```sql
-- 계정은 'ID'@'HOST' 형식으로 이루어진다.
$ CREATE USER 'foo'@'localhost' IDENTIFIED BY '1234';
```

- `%`로 설정 시 모든 접속을 허용한다.
- `localhost`로 설정 시 로컬에서만 접속을 허용한다.
- `111.111.0.1`처럼 특정 IP로 설정 시 해당 IP에서만 접속을 허용한다.

### 사용자 이름 변경

```sql
$ RENAME USER 'foo'@'localhost' to 'bar'@'%';
```

### 사용자 비밀번호 변경

```sql
$ SET PASSWORD FOR 'foo'@'localhost' = PASSWORD('12345');
```

### 사용자 삭제

```sql
$ DROP USER 'foo'@'localhost';
```

### 사용자 권한 부여

```sql
-- 해당 사용자에게 test 데이터베이스에 대한 전체 권한 부여
$ GRANT ALL PRIVILEGES ON test.* TO 'foo'@'localhost';

-- 특정 DB의 테이블에만 권한부여
-- test 데이터베이스의 User 테이블에 대한 SELECT 권한 허용 (허용 권한을 여러 개 주는 것도 가능하다)
$ GRANT SELECT ON test.User TO 'foo'@'localhost';

-- foo는 최초 root에게 권한을 부여받은 상태이다.
-- WITH GRANT OPTION을 사용하면 foo 사용자가 가진 권한을 다른 사용자에게 부여할 수 있다.
$ GRANT SELECT, DELETE, INSERT ON test.User TO 'foo'@'localhost' WITH GRANT OPTION;
```

### 사용자 권한 회수

```sql
-- test 데이터베이스의 모든 테이블에 대한 전체 권한 회수
$ REVOKE ALL ON test.* FROM 'foo'@'localhost';

-- test 데이터베이스의 모든 테이블에 대한 INSERT 권한 회수
$ REVOKE INSERT ON test.* FROM 'foo'@'localhost';

-- foo 사용자로부터 권한을 부여할 권한을 회수
$ REVOKE GRANT OPTION ON SELECT ON test.* FROM 'foo'@'localhost';
```

### ROLE 생성

```sql
-- ROLE 생성
$ CREATE ROLE '롤 이름';
$ CREATE ROLE 'MEMBER';

-- ROLE이 가진 권한 조회
$ SHOW GRANTS FOR '롤 이름';
$ SHOW GRANTS FOR 'MEMBER';

-- ROLE 삭제
$ DROP ROLE '롤 이름';
$ DROP ROLE 'MEMBER';

-- ROLE 권한 설정
$ GRANT ALL PRIVILEGES ON test.* TO '롤 이름';

-- ADMIN ROLE에 test 데이터베이스에 대한 전체 권한 부여
$ GRANT ALL PRIVILEGES ON test.* TO 'ADMIN';

-- MEMBER ROLE에 test 데이터베이스에 대한 SELECT, INSERT 권한 부여
$ GRANT SELECT, INSERT ON test.* TO 'MEMBER';

-- 계정에 ROLE 설정
-- MEMBER ROLE이 INSERT, SELECT 권한이 있으면 yoon은 INSERT SELECT 권한을 부여받는다.
$ GRANT 'MEMBER' TO 'yoon'@'localhost';

-- 특정 계정이 가진 ROLE 권한 확인
$ SHOW GRANT FOR 'yoon'@'localhost' USING '롤 이름';
$ SHOW GRANT FOR 'yoon'@'localhost' USING 'MEMBER';

-- ROLE 활성화
-- 1. root 계정이 활성화
$ SET DEFAULT ROLE MEMBER TO 'yoon'@'localhost';

-- 2. 자신이 가지고 있는 ROLE을 활성화
$ SET ROLE MEMBER;
```

- ROLE 생성 시 해당 ROLE 이름으로 사용자 계정을 생성할 수 없다.

---

#### 참고

- <https://stricky.tistory.com/110>